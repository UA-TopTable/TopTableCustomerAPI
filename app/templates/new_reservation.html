<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Reservation</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6 text-center">
                <button type="button" class="btn btn-primary btn-lg" data-toggle="modal"
                    data-target="#reservationModal">
                    Create New Reservation
                </button>
            </div>
        </div>
    </div>
    <div class="modal" id="reservationModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">New Reservation</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal Body -->
                <div class="modal-body">
                    <form id="reservationForm">
                        <div class="form-group">
                            <label for="user_id">User ID:</label>
                            <input type="text" class="form-control" id="user_id" required>
                        </div>
                        <div class="form-group">
                            <label for="restaurant_id">Restaurant ID:</label>
                            <input type="text" class="form-control" id="restaurant_id" required>
                        </div>
                        <div class="form-group">
                            <label for="dining_table_id">Dining Table ID:</label>
                            <input type="text" class="form-control" id="dining_table_id" required>
                        </div>
                        <div class="form-group">
                            <label for="number_of_people">Number of People:</label>
                            <input type="number" class="form-control" id="number_of_people" required>
                        </div>
                        <div class="form-group">
                            <label for="reservation_date">Reservation Date:</label>
                            <input type="date" class="form-control" id="reservation_date" required>
                        </div>
                        <div class="form-group">
                            <label for="reservation_time_slot">Reservation Time Slot:</label>
                            <select class="form-control" id="reservation_time_slot" required>
                                <option value="10:00-10:30">10:00 - 10:30</option>
                                <option value="10:30-11:00">10:30 - 11:00</option>
                                <option value="11:00-11:30">11:00 - 11:30</option>
                                <option value="11:30-12:00">11:30 - 12:00</option>
                                <option value="12:00-12:30">12:00 - 12:30</option>
                                <option value="12:30-13:00">12:30 - 13:00</option>
                                <option value="13:00-13:30">13:00 - 13:30</option>
                                <option value="13:30-14:00">13:30 - 14:00</option>
                                <option value="14:00-14:30">14:00 - 14:30</option>
                                <option value="14:30-15:00">14:30 - 15:00</option>
                                <option value="15:00-15:30">15:00 - 15:30</option>
                                <option value="15:30-16:00">15:30 - 16:00</option>
                                <option value="16:00-16:30">16:00 - 16:30</option>
                                <option value="16:30-17:00">16:30 - 17:00</option>
                                <option value="17:00-17:30">17:00 - 17:30</option>
                                <option value="17:30-18:00">17:30 - 18:00</option>
                                <option value="18:00-18:30">18:00 - 18:30</option>
                                <option value="18:30-19:00">18:30 - 19:00</option>
                                <option value="19:00-19:30">19:00 - 19:30</option>
                                <option value="19:30-20:00">19:30 - 20:00</option>
                                <option value="20:00-20:30">20:00 - 20:30</option>
                                <option value="20:30-21:00">20:30 - 21:00</option>
                                <option value="21:00-21:30">21:00 - 21:30</option>
                                <option value="21:30-22:00">21:30 - 22:00</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="special_requests">Special Requests:</label>
                            <input type="text" class="form-control" id="special_requests">
                        </div>
                    </form>
                </div>

                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="submitReservation()">Submit</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        function submitReservation() {
            const formData = {
                user_id: document.getElementById('user_id').value,
                restaurant_id: document.getElementById('restaurant_id').value,
                dining_table_id: document.getElementById('dining_table_id').value,
                number_of_people: document.getElementById('number_of_people').value,
                reservation_time_slot: document.getElementById('reservation_time_slot').value,
                reservation_date: document.getElementById('reservation_date').value,
                special_requests: document.getElementById('special_requests').value
            };

            // Check for null or empty values
            for (const key in formData) {
                if (formData[key] === null || formData[key] === '') {
                    alert(`Please fill out the ${key.replace('_', ' ')} field.`);
                    return;
                }
            }

            fetch('/api/v1/reservation', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
                .then(response => {
                    if (response.status === 201) {
                        response.text().then(text => {
                            alert('Reservation saved id: ' + text);
                            $('#reservationModal').modal('hide');
                        });
                        $('#reservationModal').modal('hide');
                    } else {
                        alert('Error: ' + response.statusText);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    </script>
</body>

</html>